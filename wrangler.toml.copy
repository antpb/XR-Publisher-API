name = "xr-publisher"
main = "dist/worker.js"
compatibility_date = "2024-09-23"
compatibility_flags = ["nodejs_compat"]
account_id = ""

[[rules]]
type = "ESModule"
globs = ["**/*.js"]

# Rest of your existing configuration...
kv_namespaces = [
    { binding = "VISIT_COUNTS", id = "" }
]

[ai]
binding = "AI"

[observability]
enabled = true
head_sampling_rate = 1

[triggers]
crons = ["*/5 * * * *"]

[[durable_objects.bindings]]
name = "WORLD_REGISTRY"
class_name = "WorldRegistryDO"

[[durable_objects.bindings]]
name = "USER_AUTH"
class_name = "UserAuthDO"

[[durable_objects.bindings]]
name = "CHARACTER_REGISTRY"
class_name = "CharacterRegistryDO"

[[migrations]]
tag = "v1"
new_sqlite_classes = ["WorldRegistryDO"]

[[migrations]]
tag = "v2"
new_sqlite_classes = ["UserAuthDO"]

[[migrations]]
tag = "v3"
new_sqlite_classes = ["CharacterRegistryDO"]

[vars]
ENVIRONMENT = "production"
WORLD_BUCKET_URL = "https://your-world-bucket-url"
OPENAI_API_KEY = "your-openai-api-key"
ANTHROPIC_API_KEY = "your-anthropic-api-key"
CF_ACCOUNT_ID = "your-cf-account-id"
CF_GATEWAY_ID = "your-cf-gateway-id"
SENTRY_DSN = "your-sentry-dsn"
SENTRY_ORG = "your-sentry-org"
SENTRY_PROJECT = "your-sentry-project"
SENTRY_AUTH_TOKEN = "your-sentry-auth-token"

[[r2_buckets]]
binding = "WORLD_BUCKET"
bucket_name = "your-bucket-name"
preview_bucket_name = "your-preview-bucket-name"

[env.production]
vars = { ENVIRONMENT = "production" }